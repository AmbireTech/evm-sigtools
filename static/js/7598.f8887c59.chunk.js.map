{"version":3,"file":"static/js/7598.f8887c59.chunk.js","mappings":"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","sources":["../node_modules/@safe-global/safe-apps-provider/src/index.ts","../node_modules/@safe-global/safe-apps-provider/src/provider.ts","../node_modules/@safe-global/safe-apps-provider/src/utils.ts"],"sourcesContent":["export { SafeAppProvider } from './provider';\r\n","import SafeAppsSDK, { SafeInfo, Web3TransactionObject } from '@safe-global/safe-apps-sdk';\r\nimport { EventEmitter } from 'events';\r\nimport { EIP1193Provider } from './types';\r\nimport { getLowerCase } from './utils';\r\n\r\n// The API is based on Ethereum JavaScript API Provider Standard. Link: https://eips.ethereum.org/EIPS/eip-1193\r\nexport class SafeAppProvider extends EventEmitter implements EIP1193Provider {\r\n  private readonly safe: SafeInfo;\r\n  private readonly sdk: SafeAppsSDK;\r\n  private submittedTxs = new Map<string, Web3TransactionObject>();\r\n\r\n  constructor(safe: SafeInfo, sdk: SafeAppsSDK) {\r\n    super();\r\n    this.safe = safe;\r\n    this.sdk = sdk;\r\n  }\r\n\r\n  async connect(): Promise<void> {\r\n    this.emit('connect', { chainId: this.chainId });\r\n    return;\r\n  }\r\n\r\n  async disconnect(): Promise<void> {\r\n    return;\r\n  }\r\n\r\n  public get chainId(): number {\r\n    return this.safe.chainId;\r\n  }\r\n\r\n  // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n  async request(request: { method: string; params?: any[] }): Promise<any> {\r\n    const { method, params = [] } = request;\r\n\r\n    switch (method) {\r\n      case 'eth_accounts':\r\n        return [this.safe.safeAddress];\r\n\r\n      case 'net_version':\r\n      case 'eth_chainId':\r\n        return `0x${this.chainId.toString(16)}`;\r\n\r\n      case 'personal_sign': {\r\n        const [message, address] = params;\r\n\r\n        if (this.safe.safeAddress.toLowerCase() !== address.toLowerCase()) {\r\n          throw new Error('The address or message hash is invalid');\r\n        }\r\n\r\n        const response = await this.sdk.txs.signMessage(message);\r\n        const signature = 'signature' in response ? response.signature : undefined;\r\n\r\n        return signature || '0x';\r\n      }\r\n\r\n      case 'eth_sign': {\r\n        const [address, messageHash] = params;\r\n\r\n        if (this.safe.safeAddress.toLowerCase() !== address.toLowerCase() || !messageHash.startsWith('0x')) {\r\n          throw new Error('The address or message hash is invalid');\r\n        }\r\n\r\n        const response = await this.sdk.txs.signMessage(messageHash);\r\n        const signature = 'signature' in response ? response.signature : undefined;\r\n\r\n        return signature || '0x';\r\n      }\r\n\r\n      case 'eth_signTypedData':\r\n      case 'eth_signTypedData_v4': {\r\n        const [address, typedData] = params;\r\n        const parsedTypedData = typeof typedData === 'string' ? JSON.parse(typedData) : typedData;\r\n\r\n        if (this.safe.safeAddress.toLowerCase() !== address.toLowerCase()) {\r\n          throw new Error('The address is invalid');\r\n        }\r\n\r\n        const response = await this.sdk.txs.signTypedMessage(parsedTypedData);\r\n        const signature = 'signature' in response ? response.signature : undefined;\r\n        return signature || '0x';\r\n      }\r\n\r\n      case 'eth_sendTransaction':\r\n        const tx = {\r\n          value: '0',\r\n          data: '0x',\r\n          ...params[0],\r\n        };\r\n\r\n        // Some ethereum libraries might pass the gas as a hex-encoded string\r\n        // We need to convert it to a number because the SDK expects a number and our backend only supports\r\n        // Decimal numbers\r\n        if (typeof tx.gas === 'string' && tx.gas.startsWith('0x')) {\r\n          tx.gas = parseInt(tx.gas, 16);\r\n        }\r\n\r\n        const resp = await this.sdk.txs.send({\r\n          txs: [tx],\r\n          params: { safeTxGas: tx.gas },\r\n        });\r\n\r\n        // Store fake transaction\r\n        this.submittedTxs.set(resp.safeTxHash, {\r\n          from: this.safe.safeAddress,\r\n          hash: resp.safeTxHash,\r\n          gas: 0,\r\n          gasPrice: '0x00',\r\n          nonce: 0,\r\n          input: tx.data,\r\n          value: tx.value,\r\n          to: tx.to,\r\n          blockHash: null,\r\n          blockNumber: null,\r\n          transactionIndex: null,\r\n        });\r\n        return resp.safeTxHash;\r\n\r\n      case 'eth_blockNumber':\r\n        const block = await this.sdk.eth.getBlockByNumber(['latest']);\r\n\r\n        return block.number;\r\n\r\n      case 'eth_getBalance':\r\n        return this.sdk.eth.getBalance([getLowerCase(params[0]), params[1]]);\r\n\r\n      case 'eth_getCode':\r\n        return this.sdk.eth.getCode([getLowerCase(params[0]), params[1]]);\r\n\r\n      case 'eth_getTransactionCount':\r\n        return this.sdk.eth.getTransactionCount([getLowerCase(params[0]), params[1]]);\r\n\r\n      case 'eth_getStorageAt':\r\n        return this.sdk.eth.getStorageAt([getLowerCase(params[0]), params[1], params[2]]);\r\n\r\n      case 'eth_getBlockByNumber':\r\n        return this.sdk.eth.getBlockByNumber([params[0], params[1]]);\r\n\r\n      case 'eth_getBlockByHash':\r\n        return this.sdk.eth.getBlockByHash([params[0], params[1]]);\r\n\r\n      case 'eth_getTransactionByHash':\r\n        let txHash = params[0];\r\n        try {\r\n          const resp = await this.sdk.txs.getBySafeTxHash(txHash);\r\n          txHash = resp.txHash || txHash;\r\n        } catch (e) {}\r\n        // Use fake transaction if we don't have a real tx hash\r\n        if (this.submittedTxs.has(txHash)) {\r\n          return this.submittedTxs.get(txHash);\r\n        }\r\n        return this.sdk.eth.getTransactionByHash([txHash]).then((tx) => {\r\n          // We set the tx hash to the one requested, as some provider assert this\r\n          if (tx) {\r\n            tx.hash = params[0];\r\n          }\r\n          return tx;\r\n        });\r\n\r\n      case 'eth_getTransactionReceipt': {\r\n        let txHash = params[0];\r\n        try {\r\n          const resp = await this.sdk.txs.getBySafeTxHash(txHash);\r\n          txHash = resp.txHash || txHash;\r\n        } catch (e) {}\r\n        return this.sdk.eth.getTransactionReceipt([txHash]).then((tx) => {\r\n          // We set the tx hash to the one requested, as some provider assert this\r\n          if (tx) {\r\n            tx.transactionHash = params[0];\r\n          }\r\n          return tx;\r\n        });\r\n      }\r\n\r\n      case 'eth_estimateGas': {\r\n        return this.sdk.eth.getEstimateGas(params[0]);\r\n      }\r\n\r\n      case 'eth_call': {\r\n        return this.sdk.eth.call([params[0], params[1]]);\r\n      }\r\n\r\n      case 'eth_getLogs':\r\n        return this.sdk.eth.getPastLogs([params[0]]);\r\n\r\n      case 'eth_gasPrice':\r\n        return this.sdk.eth.getGasPrice();\r\n\r\n      case 'wallet_getPermissions':\r\n        return this.sdk.wallet.getPermissions();\r\n\r\n      case 'wallet_requestPermissions':\r\n        return this.sdk.wallet.requestPermissions(params[0]);\r\n\r\n      case 'safe_setSettings':\r\n        return this.sdk.eth.setSafeSettings([params[0]]);\r\n\r\n      default:\r\n        throw Error(`\"${request.method}\" not implemented`);\r\n    }\r\n  }\r\n\r\n  // this method is needed for ethers v4\r\n  // https://github.com/ethers-io/ethers.js/blob/427e16826eb15d52d25c4f01027f8db22b74b76c/src.ts/providers/web3-provider.ts#L41-L55\r\n  send(request: any, callback: (error: any, response?: any) => void): void {\r\n    if (!request) callback('Undefined request');\r\n    this.request(request)\r\n      .then((result) => callback(null, { jsonrpc: '2.0', id: request.id, result }))\r\n      .catch((error) => callback(error, null));\r\n  }\r\n}\r\n","export function getLowerCase(value: string): string {\r\n  if (value) {\r\n    return value.toLowerCase();\r\n  }\r\n  return value;\r\n}\r\n"],"names":["Object","enumerable","get","SafeAppProvider","safe","sdk","submittedTxs","Map","this","emit","chainId","request","method","params","safeAddress","toString","message","address","toLowerCase","Error","txs","signMessage","response","signature","undefined","messageHash","startsWith","typedData","parsedTypedData","JSON","parse","signTypedMessage","tx","value","data","gas","parseInt","send","safeTxGas","resp","set","safeTxHash","from","hash","gasPrice","nonce","input","to","blockHash","blockNumber","transactionIndex","eth","getBlockByNumber","block","number","getBalance","getLowerCase","getCode","getTransactionCount","getStorageAt","getBlockByHash","txHash","getBySafeTxHash","has","getTransactionByHash","then","getTransactionReceipt","transactionHash","getEstimateGas","call","getPastLogs","getGasPrice","wallet","getPermissions","requestPermissions","setSafeSettings","callback","result","jsonrpc","id","catch","error","events_1","exports"],"sourceRoot":""}