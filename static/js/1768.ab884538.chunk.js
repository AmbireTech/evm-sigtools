/*! For license information please see 1768.ab884538.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkevm_sigtools=self.webpackChunkevm_sigtools||[]).push([[1768],{71768:function(t,r,n){n.r(r),n.d(r,{encodeToCurve:function(){return Br},hashToCurve:function(){return Er},schnorr:function(){return pr},secp256k1:function(){return $t}});var e={};n.r(e),n.d(e,{bitGet:function(){return X},bitLen:function(){return G},bitMask:function(){return Q},bitSet:function(){return J},bytesToHex:function(){return H},bytesToNumberBE:function(){return V},bytesToNumberLE:function(){return F},concatBytes:function(){return M},createHmacDrbg:function(){return rt},ensureBytes:function(){return j},equalBytes:function(){return W},hexToBytes:function(){return D},hexToNumber:function(){return P},numberToBytesBE:function(){return _},numberToBytesLE:function(){return z},numberToHexUnpadded:function(){return C},numberToVarBytesBE:function(){return K},utf8ToBytes:function(){return Y},validateObject:function(){return et}});var i=n(47061),o=n(59900),a=n(24269),u=n(38114),f=n(15819);function s(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("Wrong positive integer: ".concat(t))}function c(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");for(var r=arguments.length,n=new Array(r>1?r-1:0),e=1;e<r;e++)n[e-1]=arguments[e];if(n.length>0&&!n.includes(t.length))throw new Error("Expected Uint8Array of length ".concat(n,", not of length=").concat(t.length))}function d(t){if("function"!==typeof t||"function"!==typeof t.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");s(t.outputLen),s(t.blockLen)}function h(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.destroyed)throw new Error("Hash instance has been destroyed");if(r&&t.finished)throw new Error("Hash#digest() has already been called")}function l(t,r){c(t);var n=r.outputLen;if(t.length<n)throw new Error("digestInto() expects output buffer of length at least ".concat(n))}n(50107);var v="object"===typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,y=function(t){return t instanceof Uint8Array},g=function(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)},p=function(t,r){return t<<32-r|t>>>r};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");function w(t){if("string"===typeof t&&(t=function(t){if("string"!==typeof t)throw new Error("utf8ToBytes expected string, got ".concat(typeof t));return new Uint8Array((new TextEncoder).encode(t))}(t)),!y(t))throw new Error("expected Uint8Array, got ".concat(typeof t));return t}function m(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var e=new Uint8Array(r.reduce((function(t,r){return t+r.length}),0)),i=0;return r.forEach((function(t){if(!y(t))throw new Error("Uint8Array expected");e.set(t,i),i+=t.length})),e}var b=function(){function t(){(0,i.Z)(this,t)}return(0,o.Z)(t,[{key:"clone",value:function(){return this._cloneInto()}}]),t}();function E(t){var r=function(r){return t().update(w(r)).digest()},n=t();return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=function(){return t()},r}function B(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(v&&"function"===typeof v.getRandomValues)return v.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}var x=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(t,e,o,a){var u;return(0,i.Z)(this,n),(u=r.call(this)).blockLen=t,u.outputLen=e,u.padOffset=o,u.isLE=a,u.finished=!1,u.length=0,u.pos=0,u.destroyed=!1,u.buffer=new Uint8Array(t),u.view=g(u.buffer),u}return(0,o.Z)(n,[{key:"update",value:function(t){h(this);for(var r=this.view,n=this.buffer,e=this.blockLen,i=(t=w(t)).length,o=0;o<i;){var a=Math.min(e-this.pos,i-o);if(a!==e)n.set(t.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===e&&(this.process(r,0),this.pos=0);else for(var u=g(t);e<=i-o;o+=e)this.process(u,o)}return this.length+=t.length,this.roundClean(),this}},{key:"digestInto",value:function(t){h(this),l(t,this),this.finished=!0;var r=this.buffer,n=this.view,e=this.blockLen,i=this.isLE,o=this.pos;r[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>e-o&&(this.process(n,0),o=0);for(var a=o;a<e;a++)r[a]=0;!function(t,r,n,e){if("function"===typeof t.setBigUint64)return t.setBigUint64(r,n,e);var i=BigInt(32),o=BigInt(4294967295),a=Number(n>>i&o),u=Number(n&o),f=e?4:0,s=e?0:4;t.setUint32(r+f,a,e),t.setUint32(r+s,u,e)}(n,e-8,BigInt(8*this.length),i),this.process(n,0);var u=g(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var s=f/4,c=this.get();if(s>c.length)throw new Error("_sha2: outputLen bigger than state");for(var d=0;d<s;d++)u.setUint32(4*d,c[d],i)}},{key:"digest",value:function(){var t=this.buffer,r=this.outputLen;this.digestInto(t);var n=t.slice(0,r);return this.destroy(),n}},{key:"_cloneInto",value:function(t){var r;t||(t=new this.constructor),(r=t).set.apply(r,(0,f.Z)(this.get()));var n=this.blockLen,e=this.buffer,i=this.length,o=this.finished,a=this.destroyed,u=this.pos;return t.length=i,t.pos=u,t.finished=o,t.destroyed=a,i%n&&t.buffer.set(e),t}}]),n}(b),A=function(t,r,n){return t&r^t&n^r&n},I=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),S=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),k=new Uint32Array(64),O=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t;return(0,i.Z)(this,n),(t=r.call(this,64,32,8,!1)).A=0|S[0],t.B=0|S[1],t.C=0|S[2],t.D=0|S[3],t.E=0|S[4],t.F=0|S[5],t.G=0|S[6],t.H=0|S[7],t}return(0,o.Z)(n,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(t,r,n,e,i,o,a,u){this.A=0|t,this.B=0|r,this.C=0|n,this.D=0|e,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|u}},{key:"process",value:function(t,r){for(var n=0;n<16;n++,r+=4)k[n]=t.getUint32(r,!1);for(var e=16;e<64;e++){var i=k[e-15],o=k[e-2],a=p(i,7)^p(i,18)^i>>>3,u=p(o,17)^p(o,19)^o>>>10;k[e]=u+k[e-7]+a+k[e-16]|0}var f,s=this.A,c=this.B,d=this.C,h=this.D,l=this.E,v=this.F,y=this.G,g=this.H;for(n=0;n<64;n++){var w=g+(p(l,6)^p(l,11)^p(l,25))+((f=l)&v^~f&y)+I[n]+k[n]|0,m=(p(s,2)^p(s,13)^p(s,22))+A(s,c,d)|0;g=y,y=v,v=l,l=h+w|0,h=d,d=c,c=s,s=w+m|0}s=s+this.A|0,c=c+this.B|0,d=d+this.C|0,h=h+this.D|0,l=l+this.E|0,v=v+this.F|0,y=y+this.G|0,g=g+this.H|0,this.set(s,c,d,h,l,v,y,g)}},{key:"roundClean",value:function(){k.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}]),n}(x),Z=E((function(){return new O})),R=n(72256),U=BigInt(0),q=BigInt(1),T=BigInt(2),L=function(t){return t instanceof Uint8Array},N=Array.from({length:256},(function(t,r){return r.toString(16).padStart(2,"0")}));function H(t){if(!L(t))throw new Error("Uint8Array expected");for(var r="",n=0;n<t.length;n++)r+=N[t[n]];return r}function C(t){var r=t.toString(16);return 1&r.length?"0".concat(r):r}function P(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);return BigInt(""===t?"0":"0x".concat(t))}function D(t){if("string"!==typeof t)throw new Error("hex string expected, got "+typeof t);var r=t.length;if(r%2)throw new Error("padded hex string expected, got unpadded hex of length "+r);for(var n=new Uint8Array(r/2),e=0;e<n.length;e++){var i=2*e,o=t.slice(i,i+2),a=Number.parseInt(o,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");n[e]=a}return n}function V(t){return P(H(t))}function F(t){if(!L(t))throw new Error("Uint8Array expected");return P(H(Uint8Array.from(t).reverse()))}function _(t,r){return D(t.toString(16).padStart(2*r,"0"))}function z(t,r){return _(t,r).reverse()}function K(t){return D(C(t))}function j(t,r,n){var e;if("string"===typeof r)try{e=D(r)}catch(o){throw new Error("".concat(t,' must be valid hex string, got "').concat(r,'". Cause: ').concat(o))}else{if(!L(r))throw new Error("".concat(t," must be hex string or Uint8Array"));e=Uint8Array.from(r)}var i=e.length;if("number"===typeof n&&i!==n)throw new Error("".concat(t," expected ").concat(n," bytes, got ").concat(i));return e}function M(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var e=new Uint8Array(r.reduce((function(t,r){return t+r.length}),0)),i=0;return r.forEach((function(t){if(!L(t))throw new Error("Uint8Array expected");e.set(t,i),i+=t.length})),e}function W(t,r){if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==r[n])return!1;return!0}function Y(t){if("string"!==typeof t)throw new Error("utf8ToBytes expected string, got ".concat(typeof t));return new Uint8Array((new TextEncoder).encode(t))}function G(t){var r;for(r=0;t>U;t>>=q,r+=1);return r}function X(t,r){return t>>BigInt(r)&q}var J=function(t,r,n){return t|(n?q:U)<<BigInt(r)},Q=function(t){return(T<<BigInt(t-1))-q},$=function(t){return new Uint8Array(t)},tt=function(t){return Uint8Array.from(t)};function rt(t,r,n){if("number"!==typeof t||t<2)throw new Error("hashLen must be a number");if("number"!==typeof r||r<2)throw new Error("qByteLen must be a number");if("function"!==typeof n)throw new Error("hmacFn must be a function");var e=$(t),i=$(t),o=0,a=function(){e.fill(1),i.fill(0),o=0},u=function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return n.apply(void 0,[i,e].concat(r))},f=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:$();i=u(tt([0]),t),e=u(),0!==t.length&&(i=u(tt([1]),t),e=u())},s=function(){if(o++>=1e3)throw new Error("drbg: tried 1000 values");for(var t=0,n=[];t<r;){var i=(e=u()).slice();n.push(i),t+=e.length}return M.apply(void 0,n)};return function(t,r){a(),f(t);for(var n=void 0;!(n=r(s()));)f();return a(),n}}var nt={bigint:function(t){return"bigint"===typeof t},function:function(t){return"function"===typeof t},boolean:function(t){return"boolean"===typeof t},string:function(t){return"string"===typeof t},stringOrUint8Array:function(t){return"string"===typeof t||t instanceof Uint8Array},isSafeInteger:function(t){return Number.isSafeInteger(t)},array:function(t){return Array.isArray(t)},field:function(t,r){return r.Fp.isValid(t)},hash:function(t){return"function"===typeof t&&Number.isSafeInteger(t.outputLen)}};function et(t,r){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=function(r,n,e){var i=nt[n];if("function"!==typeof i)throw new Error('Invalid validator "'.concat(n,'", expected function'));var o=t[r];if((!e||void 0!==o)&&!i(o,t))throw new Error("Invalid param ".concat(String(r),"=").concat(o," (").concat(typeof o,"), expected ").concat(n))},i=0,o=Object.entries(r);i<o.length;i++){var a=(0,R.Z)(o[i],2);e(a[0],a[1],!1)}for(var u=0,f=Object.entries(n);u<f.length;u++){var s=(0,R.Z)(f[u],2);e(s[0],s[1],!0)}return t}var it=BigInt(0),ot=BigInt(1),at=BigInt(2),ut=BigInt(3),ft=BigInt(4),st=BigInt(5),ct=BigInt(8);BigInt(9),BigInt(16);function dt(t,r){var n=t%r;return n>=it?n:r+n}function ht(t,r,n){if(n<=it||r<it)throw new Error("Expected power/modulo > 0");if(n===ot)return it;for(var e=ot;r>it;)r&ot&&(e=e*t%n),t=t*t%n,r>>=ot;return e}function lt(t,r,n){for(var e=t;r-- >it;)e*=e,e%=n;return e}function vt(t,r){if(t===it||r<=it)throw new Error("invert: expected positive integers, got n=".concat(t," mod=").concat(r));for(var n=dt(t,r),e=r,i=it,o=ot,a=ot,u=it;n!==it;){var f=e/n,s=e%n,c=i-a*f,d=o-u*f;e=n,n=s,i=a,o=u,a=c,u=d}if(e!==ot)throw new Error("invert: does not exist");return dt(i,r)}function yt(t){if(t%ft===ut){var r=(t+ot)/ft;return function(t,n){var e=t.pow(n,r);if(!t.eql(t.sqr(e),n))throw new Error("Cannot find square root");return e}}if(t%ct===st){var n=(t-st)/ct;return function(t,r){var e=t.mul(r,at),i=t.pow(e,n),o=t.mul(r,i),a=t.mul(t.mul(o,at),i),u=t.mul(o,t.sub(a,t.ONE));if(!t.eql(t.sqr(u),r))throw new Error("Cannot find square root");return u}}return function(t){var r,n,e,i=(t-ot)/at;for(r=t-ot,n=0;r%at===it;r/=at,n++);for(e=at;e<t&&ht(e,i,t)!==t-ot;e++);if(1===n){var o=(t+ot)/ft;return function(t,r){var n=t.pow(r,o);if(!t.eql(t.sqr(n),r))throw new Error("Cannot find square root");return n}}var a=(r+ot)/at;return function(t,o){if(t.pow(o,i)===t.neg(t.ONE))throw new Error("Cannot find square root");for(var u=n,f=t.pow(t.mul(t.ONE,e),r),s=t.pow(o,a),c=t.pow(o,r);!t.eql(c,t.ONE);){if(t.eql(c,t.ZERO))return t.ZERO;for(var d=1,h=t.sqr(c);d<u&&!t.eql(h,t.ONE);d++)h=t.sqr(h);var l=t.pow(f,ot<<BigInt(u-d-1));f=t.sqr(l),s=t.mul(s,l),c=t.mul(c,f),u=d}return s}}(t)}var gt=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function pt(t){return et(t,gt.reduce((function(t,r){return t[r]="function",t}),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"}))}function wt(t,r){var n=void 0!==r?r:t.toString(2).length;return{nBitLength:n,nByteLength:Math.ceil(n/8)}}function mt(t){if("bigint"!==typeof t)throw new Error("field order must be bigint");var r=t.toString(2).length;return Math.ceil(r/8)}function bt(t){var r=mt(t);return r+Math.ceil(r/2)}var Et=n(73133),Bt=n(19677),xt=BigInt(0),At=BigInt(1);function It(t){return pt(t.Fp),et(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze((0,Bt.Z)((0,Bt.Z)((0,Bt.Z)({},wt(t.n,t.nBitLength)),t),{p:t.Fp.ORDER}))}var St=V,kt=D,Ot={Err:function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,i.Z)(this,n),r.call(this,t)}return(0,o.Z)(n)}((0,Et.Z)(Error)),_parseInt:function(t){var r=Ot.Err;if(t.length<2||2!==t[0])throw new r("Invalid signature integer tag");var n=t[1],e=t.subarray(2,n+2);if(!n||e.length!==n)throw new r("Invalid signature integer: wrong length");if(128&e[0])throw new r("Invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new r("Invalid signature integer: unnecessary leading zero");return{d:St(e),l:t.subarray(n+2)}},toSig:function(t){var r=Ot.Err,n="string"===typeof t?kt(t):t;if(!(n instanceof Uint8Array))throw new Error("ui8a expected");var e=n.length;if(e<2||48!=n[0])throw new r("Invalid signature tag");if(n[1]!==e-2)throw new r("Invalid signature: incorrect length");var i=Ot._parseInt(n.subarray(2)),o=i.d,a=i.l,u=Ot._parseInt(a),f=u.d;if(u.l.length)throw new r("Invalid signature: left bytes after parsing");return{r:o,s:f}},hexFromSig:function(t){var r=function(t){return 8&Number.parseInt(t[0],16)?"00"+t:t},n=function(t){var r=t.toString(16);return 1&r.length?"0".concat(r):r},e=r(n(t.s)),i=r(n(t.r)),o=e.length/2,a=i.length/2,u=n(o),f=n(a);return"30".concat(n(a+o+4),"02").concat(f).concat(i,"02").concat(u).concat(e)}},Zt=BigInt(0),Rt=BigInt(1),Ut=BigInt(2),qt=BigInt(3),Tt=BigInt(4);function Lt(t){var r=function(t){var r=It(t);et(r,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});var n=r.endo,e=r.Fp,i=r.a;if(n){if(!e.eql(i,e.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if("object"!==typeof n||"bigint"!==typeof n.beta||"function"!==typeof n.splitScalar)throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze((0,Bt.Z)({},r))}(t),n=r.Fp,e=r.toBytes||function(t,r,e){var i=r.toAffine();return M(Uint8Array.from([4]),n.toBytes(i.x),n.toBytes(i.y))},a=r.fromBytes||function(t){var r=t.subarray(1);return{x:n.fromBytes(r.subarray(0,n.BYTES)),y:n.fromBytes(r.subarray(n.BYTES,2*n.BYTES))}};function u(t){var e=r.a,i=r.b,o=n.sqr(t),a=n.mul(o,t);return n.add(n.add(a,n.mul(t,e)),i)}if(!n.eql(n.sqr(r.Gy),u(r.Gx)))throw new Error("bad generator point: equation left != right");function f(t){return"bigint"===typeof t&&Zt<t&&t<r.n}function s(t){if(!f(t))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(t){var n,e=r.allowedPrivateKeyLengths,i=r.nByteLength,o=r.wrapPrivateKey,a=r.n;if(e&&"bigint"!==typeof t){if(t instanceof Uint8Array&&(t=H(t)),"string"!==typeof t||!e.includes(t.length))throw new Error("Invalid key");t=t.padStart(2*i,"0")}try{n="bigint"===typeof t?t:V(j("private key",t,i))}catch(u){throw new Error("private key must be ".concat(i," bytes, hex or bigint, not ").concat(typeof t))}return o&&(n=dt(n,a)),s(n),n}var d=new Map;function h(t){if(!(t instanceof l))throw new Error("ProjectivePoint expected")}var l=function(){function t(r,e,o){if((0,i.Z)(this,t),this.px=r,this.py=e,this.pz=o,null==r||!n.isValid(r))throw new Error("x required");if(null==e||!n.isValid(e))throw new Error("y required");if(null==o||!n.isValid(o))throw new Error("z required")}return(0,o.Z)(t,[{key:"x",get:function(){return this.toAffine().x}},{key:"y",get:function(){return this.toAffine().y}},{key:"_setWindowSize",value:function(t){this._WINDOW_SIZE=t,d.delete(this)}},{key:"assertValidity",value:function(){if(this.is0()){if(r.allowInfinityPoint&&!n.is0(this.py))return;throw new Error("bad point: ZERO")}var t=this.toAffine(),e=t.x,i=t.y;if(!n.isValid(e)||!n.isValid(i))throw new Error("bad point: x or y not FE");var o=n.sqr(i),a=u(e);if(!n.eql(o,a))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}},{key:"hasEvenY",value:function(){var t=this.toAffine().y;if(n.isOdd)return!n.isOdd(t);throw new Error("Field doesn't support isOdd")}},{key:"equals",value:function(t){h(t);var r=this.px,e=this.py,i=this.pz,o=t.px,a=t.py,u=t.pz,f=n.eql(n.mul(r,u),n.mul(o,i)),s=n.eql(n.mul(e,u),n.mul(a,i));return f&&s}},{key:"negate",value:function(){return new t(this.px,n.neg(this.py),this.pz)}},{key:"double",value:function(){var e=r.a,i=r.b,o=n.mul(i,qt),a=this.px,u=this.py,f=this.pz,s=n.ZERO,c=n.ZERO,d=n.ZERO,h=n.mul(a,a),l=n.mul(u,u),v=n.mul(f,f),y=n.mul(a,u);return y=n.add(y,y),d=n.mul(a,f),d=n.add(d,d),s=n.mul(e,d),c=n.mul(o,v),c=n.add(s,c),s=n.sub(l,c),c=n.add(l,c),c=n.mul(s,c),s=n.mul(y,s),d=n.mul(o,d),v=n.mul(e,v),y=n.sub(h,v),y=n.mul(e,y),y=n.add(y,d),d=n.add(h,h),h=n.add(d,h),h=n.add(h,v),h=n.mul(h,y),c=n.add(c,h),v=n.mul(u,f),v=n.add(v,v),h=n.mul(v,y),s=n.sub(s,h),d=n.mul(v,l),d=n.add(d,d),new t(s,c,d=n.add(d,d))}},{key:"add",value:function(e){h(e);var i=this.px,o=this.py,a=this.pz,u=e.px,f=e.py,s=e.pz,c=n.ZERO,d=n.ZERO,l=n.ZERO,v=r.a,y=n.mul(r.b,qt),g=n.mul(i,u),p=n.mul(o,f),w=n.mul(a,s),m=n.add(i,o),b=n.add(u,f);m=n.mul(m,b),b=n.add(g,p),m=n.sub(m,b),b=n.add(i,a);var E=n.add(u,s);return b=n.mul(b,E),E=n.add(g,w),b=n.sub(b,E),E=n.add(o,a),c=n.add(f,s),E=n.mul(E,c),c=n.add(p,w),E=n.sub(E,c),l=n.mul(v,b),c=n.mul(y,w),l=n.add(c,l),c=n.sub(p,l),l=n.add(p,l),d=n.mul(c,l),p=n.add(g,g),p=n.add(p,g),w=n.mul(v,w),b=n.mul(y,b),p=n.add(p,w),w=n.sub(g,w),w=n.mul(v,w),b=n.add(b,w),g=n.mul(p,b),d=n.add(d,g),g=n.mul(E,b),c=n.mul(m,c),c=n.sub(c,g),g=n.mul(m,p),l=n.mul(E,l),new t(c,d,l=n.add(l,g))}},{key:"subtract",value:function(t){return this.add(t.negate())}},{key:"is0",value:function(){return this.equals(t.ZERO)}},{key:"wNAF",value:function(r){return y.wNAFCached(this,d,r,(function(r){var e=n.invertBatch(r.map((function(t){return t.pz})));return r.map((function(t,r){return t.toAffine(e[r])})).map(t.fromAffine)}))}},{key:"multiplyUnsafe",value:function(e){var i=t.ZERO;if(e===Zt)return i;if(s(e),e===Rt)return this;var o=r.endo;if(!o)return y.unsafeLadder(this,e);for(var a=o.splitScalar(e),u=a.k1neg,f=a.k1,c=a.k2neg,d=a.k2,h=i,l=i,v=this;f>Zt||d>Zt;)f&Rt&&(h=h.add(v)),d&Rt&&(l=l.add(v)),v=v.double(),f>>=Rt,d>>=Rt;return u&&(h=h.negate()),c&&(l=l.negate()),l=new t(n.mul(l.px,o.beta),l.py,l.pz),h.add(l)}},{key:"multiply",value:function(e){s(e);var i,o,a=e,u=r.endo;if(u){var f=u.splitScalar(a),c=f.k1neg,d=f.k1,h=f.k2neg,l=f.k2,v=this.wNAF(d),g=v.p,p=v.f,w=this.wNAF(l),m=w.p,b=w.f;g=y.constTimeNegate(c,g),m=y.constTimeNegate(h,m),m=new t(n.mul(m.px,u.beta),m.py,m.pz),i=g.add(m),o=p.add(b)}else{var E=this.wNAF(a);i=E.p,o=E.f}return t.normalizeZ([i,o])[0]}},{key:"multiplyAndAddUnsafe",value:function(r,n,e){var i=t.BASE,o=function(t,r){return r!==Zt&&r!==Rt&&t.equals(i)?t.multiply(r):t.multiplyUnsafe(r)},a=o(this,n).add(o(r,e));return a.is0()?void 0:a}},{key:"toAffine",value:function(t){var r=this.px,e=this.py,i=this.pz,o=this.is0();null==t&&(t=o?n.ONE:n.inv(i));var a=n.mul(r,t),u=n.mul(e,t),f=n.mul(i,t);if(o)return{x:n.ZERO,y:n.ZERO};if(!n.eql(f,n.ONE))throw new Error("invZ was invalid");return{x:a,y:u}}},{key:"isTorsionFree",value:function(){var n=r.h,e=r.isTorsionFree;if(n===Rt)return!0;if(e)return e(t,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}},{key:"clearCofactor",value:function(){var n=r.h,e=r.clearCofactor;return n===Rt?this:e?e(t,this):this.multiplyUnsafe(r.h)}},{key:"toRawBytes",value:function(){var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return this.assertValidity(),e(t,this,r)}},{key:"toHex",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return H(this.toRawBytes(t))}}],[{key:"fromAffine",value:function(r){var e=r||{},i=e.x,o=e.y;if(!r||!n.isValid(i)||!n.isValid(o))throw new Error("invalid affine point");if(r instanceof t)throw new Error("projective point not allowed");var a=function(t){return n.eql(t,n.ZERO)};return a(i)&&a(o)?t.ZERO:new t(i,o,n.ONE)}},{key:"normalizeZ",value:function(r){var e=n.invertBatch(r.map((function(t){return t.pz})));return r.map((function(t,r){return t.toAffine(e[r])})).map(t.fromAffine)}},{key:"fromHex",value:function(r){var n=t.fromAffine(a(j("pointHex",r)));return n.assertValidity(),n}},{key:"fromPrivateKey",value:function(r){return t.BASE.multiply(c(r))}}]),t}();l.BASE=new l(r.Gx,r.Gy,n.ONE),l.ZERO=new l(n.ZERO,n.ONE,n.ZERO);var v=r.nBitLength,y=function(t,r){var n=function(t,r){var n=r.negate();return t?n:r},e=function(t){return{windows:Math.ceil(r/t)+1,windowSize:Math.pow(2,t-1)}};return{constTimeNegate:n,unsafeLadder:function(r,n){for(var e=t.ZERO,i=r;n>xt;)n&At&&(e=e.add(i)),i=i.double(),n>>=At;return e},precomputeWindow:function(t,r){for(var n=e(r),i=n.windows,o=n.windowSize,a=[],u=t,f=u,s=0;s<i;s++){f=u,a.push(f);for(var c=1;c<o;c++)f=f.add(u),a.push(f);u=f.double()}return a},wNAF:function(r,i,o){for(var a=e(r),u=a.windows,f=a.windowSize,s=t.ZERO,c=t.BASE,d=BigInt(Math.pow(2,r)-1),h=Math.pow(2,r),l=BigInt(r),v=0;v<u;v++){var y=v*f,g=Number(o&d);o>>=l,g>f&&(g-=h,o+=At);var p=y,w=y+Math.abs(g)-1,m=v%2!==0,b=g<0;0===g?c=c.add(n(m,i[p])):s=s.add(n(b,i[w]))}return{p:s,f:c}},wNAFCached:function(t,r,n,e){var i=t._WINDOW_SIZE||1,o=r.get(t);return o||(o=this.precomputeWindow(t,i),1!==i&&r.set(t,e(o))),this.wNAF(i,o,n)}}}(l,r.endo?Math.ceil(v/2):v);return{CURVE:r,ProjectivePoint:l,normPrivateKeyToScalar:c,weierstrassEquation:u,isWithinCurveOrder:f}}function Nt(t){var r=function(t){var r=It(t);return et(r,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze((0,Bt.Z)({lowS:!0},r))}(t),n=r.Fp,a=r.n,u=n.BYTES+1,f=2*n.BYTES+1;function s(t){return dt(t,a)}function c(t){return vt(t,a)}var d=Lt((0,Bt.Z)((0,Bt.Z)({},r),{},{toBytes:function(t,r,e){var i=r.toAffine(),o=n.toBytes(i.x),a=M;return e?a(Uint8Array.from([r.hasEvenY()?2:3]),o):a(Uint8Array.from([4]),o,n.toBytes(i.y))},fromBytes:function(t){var r=t.length,e=t[0],i=t.subarray(1);if(r!==u||2!==e&&3!==e){if(r===f&&4===e)return{x:n.fromBytes(i.subarray(0,n.BYTES)),y:n.fromBytes(i.subarray(n.BYTES,2*n.BYTES))};throw new Error("Point of length ".concat(r," was invalid. Expected ").concat(u," compressed bytes or ").concat(f," uncompressed bytes"))}var o=V(i);if(!(Zt<(a=o)&&a<n.ORDER))throw new Error("Point is not on curve");var a,s=v(o),c=n.sqrt(s);return 1===(1&e)!==((c&Rt)===Rt)&&(c=n.neg(c)),{x:o,y:c}}})),h=d.ProjectivePoint,l=d.normPrivateKeyToScalar,v=d.weierstrassEquation,y=d.isWithinCurveOrder,g=function(t){return H(_(t,r.nByteLength))};function p(t){return t>a>>Rt}var w=function(t,r,n){return V(t.slice(r,n))},m=function(){function t(r,n,e){(0,i.Z)(this,t),this.r=r,this.s=n,this.recovery=e,this.assertValidity()}return(0,o.Z)(t,[{key:"assertValidity",value:function(){if(!y(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!y(this.s))throw new Error("s must be 0 < s < CURVE.n")}},{key:"addRecoveryBit",value:function(r){return new t(this.r,this.s,r)}},{key:"recoverPublicKey",value:function(t){var e=this.r,i=this.s,o=this.recovery,a=x(j("msgHash",t));if(null==o||![0,1,2,3].includes(o))throw new Error("recovery id invalid");var u=2===o||3===o?e+r.n:e;if(u>=n.ORDER)throw new Error("recovery id 2 or 3 invalid");var f=0===(1&o)?"02":"03",d=h.fromHex(f+g(u)),l=c(u),v=s(-a*l),y=s(i*l),p=h.BASE.multiplyAndAddUnsafe(d,v,y);if(!p)throw new Error("point at infinify");return p.assertValidity(),p}},{key:"hasHighS",value:function(){return p(this.s)}},{key:"normalizeS",value:function(){return this.hasHighS()?new t(this.r,s(-this.s),this.recovery):this}},{key:"toDERRawBytes",value:function(){return D(this.toDERHex())}},{key:"toDERHex",value:function(){return Ot.hexFromSig({r:this.r,s:this.s})}},{key:"toCompactRawBytes",value:function(){return D(this.toCompactHex())}},{key:"toCompactHex",value:function(){return g(this.r)+g(this.s)}}],[{key:"fromCompact",value:function(n){var e=r.nByteLength;return n=j("compactSignature",n,2*e),new t(w(n,0,e),w(n,e,2*e))}},{key:"fromDER",value:function(r){var n=Ot.toSig(j("DER",r));return new t(n.r,n.s)}}]),t}(),b={isValidPrivateKey:function(t){try{return l(t),!0}catch(r){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:function(){var t=bt(r.n);return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=t.length,i=mt(r),o=bt(r);if(e<16||e<o||e>1024)throw new Error("expected ".concat(o,"-1024 bytes of input, got ").concat(e));var a=dt(n?V(t):F(t),r-ot)+ot;return n?z(a,i):_(a,i)}(r.randomBytes(t),r.n)},precompute:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.BASE;return r._setWindowSize(t),r.multiply(BigInt(3)),r}};function E(t){var r=t instanceof Uint8Array,n="string"===typeof t,e=(r||n)&&t.length;return r?e===u||e===f:n?e===2*u||e===2*f:t instanceof h}var B=r.bits2int||function(t){var n=V(t),e=8*t.length-r.nBitLength;return e>0?n>>BigInt(e):n},x=r.bits2int_modN||function(t){return s(B(t))},A=Q(r.nBitLength);function I(t){if("bigint"!==typeof t)throw new Error("bigint expected");if(!(Zt<=t&&t<A))throw new Error("bigint expected < 2^".concat(r.nBitLength));return _(t,r.nByteLength)}function S(t,i){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:k;if(["recovered","canonical"].some((function(t){return t in o})))throw new Error("sign() legacy options not supported");var a=r.hash,u=r.randomBytes,f=o.lowS,d=o.prehash,v=o.extraEntropy;null==f&&(f=!0),t=j("msgHash",t),d&&(t=j("prehashed msgHash",a(t)));var g=x(t),w=l(i),b=[I(w),I(g)];if(null!=v){var E=!0===v?u(n.BYTES):v;b.push(j("extraEntropy",E))}var A=M.apply(e,b),S=g;return{seed:A,k2sig:function(t){var r=B(t);if(y(r)){var n=c(r),e=h.BASE.multiply(r).toAffine(),i=s(e.x);if(i!==Zt){var o=s(n*s(S+i*w));if(o!==Zt){var a=(e.x===i?0:2)|Number(e.y&Rt),u=o;return f&&p(o)&&(u=function(t){return p(t)?s(-t):t}(o),a^=1),new m(i,u,a)}}}}}}var k={lowS:r.lowS,prehash:!1},O={lowS:r.lowS,prehash:!1};return h.BASE._setWindowSize(8),{CURVE:r,getPublicKey:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return h.fromPrivateKey(t).toRawBytes(r)},getSharedSecret:function(t,r){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(E(t))throw new Error("first arg must be private key");if(!E(r))throw new Error("second arg must be public key");return h.fromHex(r).multiply(l(t)).toRawBytes(n)},sign:function(t,n){var e=S(t,n,arguments.length>2&&void 0!==arguments[2]?arguments[2]:k),i=e.seed,o=e.k2sig,a=r;return rt(a.hash.outputLen,a.nByteLength,a.hmac)(i,o)},verify:function(t,n,e){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:O,a=t;if(n=j("msgHash",n),e=j("publicKey",e),"strict"in o)throw new Error("options.strict was renamed to lowS");var u,f=o.lowS,d=o.prehash,l=void 0;try{if("string"===typeof a||a instanceof Uint8Array)try{l=m.fromDER(a)}catch(S){if(!(S instanceof Ot.Err))throw S;l=m.fromCompact(a)}else{if("object"!==typeof a||"bigint"!==typeof a.r||"bigint"!==typeof a.s)throw new Error("PARSE");var v=a.r,y=a.s;l=new m(v,y)}u=h.fromHex(e)}catch(k){if("PARSE"===k.message)throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(f&&l.hasHighS())return!1;d&&(n=r.hash(n));var g=l,p=g.r,w=g.s,b=x(n),E=c(w),B=s(b*E),A=s(p*E),I=null===(i=h.BASE.multiplyAndAddUnsafe(u,B,A))||void 0===i?void 0:i.toAffine();return!!I&&s(I.x)===p},ProjectivePoint:h,Signature:m,utils:b}}function Ht(t,r){if(pt(t),!t.isValid(r.A)||!t.isValid(r.B)||!t.isValid(r.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");var n=function(t,r){for(var n=t.ORDER,e=Zt,i=n-Rt;i%Ut===Zt;i/=Ut)e+=Rt;var o=e,a=Ut<<o-Rt-Rt,u=a*Ut,f=(n-Rt)/u,s=(f-Rt)/Ut,c=u-Rt,d=a,h=t.pow(r,f),l=t.pow(r,(f+Rt)/Ut),v=function(r,n){var e=h,i=t.pow(n,c),a=t.sqr(i);a=t.mul(a,n);var u=t.mul(r,a);u=t.pow(u,s),u=t.mul(u,i),i=t.mul(u,n),a=t.mul(u,r);var f=t.mul(a,i);u=t.pow(f,d);var v=t.eql(u,t.ONE);i=t.mul(a,l),u=t.mul(f,e),a=t.cmov(i,a,v),f=t.cmov(u,f,v);for(var y=o;y>Rt;y--){var g=y-Ut;g=Ut<<g-Rt;var p=t.pow(f,g),w=t.eql(p,t.ONE);i=t.mul(a,e),e=t.mul(e,e),p=t.mul(f,e),a=t.cmov(i,a,w),f=t.cmov(p,f,w)}return{isValid:v,value:a}};if(t.ORDER%Tt===qt){var y=(t.ORDER-qt)/Tt,g=t.sqrt(t.neg(r));v=function(r,n){var e=t.sqr(n),i=t.mul(r,n);e=t.mul(e,i);var o=t.pow(e,y);o=t.mul(o,i);var a=t.mul(o,g),u=t.mul(t.sqr(o),n),f=t.eql(u,r);return{isValid:f,value:t.cmov(a,o,f)}}}return v}(t,r.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return function(e){var i,o,a,u,f,s,c,d;i=t.sqr(e),i=t.mul(i,r.Z),o=t.sqr(i),o=t.add(o,i),a=t.add(o,t.ONE),a=t.mul(a,r.B),u=t.cmov(r.Z,t.neg(o),!t.eql(o,t.ZERO)),u=t.mul(u,r.A),o=t.sqr(a),s=t.sqr(u),f=t.mul(s,r.A),o=t.add(o,f),o=t.mul(o,a),s=t.mul(s,u),f=t.mul(s,r.B),o=t.add(o,f),c=t.mul(i,a);var h=n(o,s),l=h.isValid,v=h.value;d=t.mul(i,e),d=t.mul(d,v),c=t.cmov(c,a,l),d=t.cmov(d,v,l);var y=t.isOdd(e)===t.isOdd(d);return d=t.cmov(t.neg(d),d,y),{x:c=t.div(c,u),y:d}}}var Ct=V;function Pt(t,r){if(t<0||t>=1<<8*r)throw new Error("bad I2OSP call: value=".concat(t," length=").concat(r));for(var n=Array.from({length:r}).fill(0),e=r-1;e>=0;e--)n[e]=255&t,t>>>=8;return new Uint8Array(n)}function Dt(t,r){for(var n=new Uint8Array(t.length),e=0;e<t.length;e++)n[e]=t[e]^r[e];return n}function Vt(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected")}function Ft(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function _t(t,r,n){et(n,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});var e=n.p,i=n.k,o=n.m,a=n.hash,u=n.expand,f=n.DST;Vt(t),Ft(r);var s,c=function(t){if(t instanceof Uint8Array)return t;if("string"===typeof t)return Y(t);throw new Error("DST must be Uint8Array or string")}(f),d=e.toString(2).length,h=Math.ceil((d+i)/8),l=r*o*h;if("xmd"===u)s=function(t,r,n,e){Vt(t),Vt(r),Ft(n),r.length>255&&(r=e(M(Y("H2C-OVERSIZE-DST-"),r)));var i=e.outputLen,o=e.blockLen,a=Math.ceil(n/i);if(a>255)throw new Error("Invalid xmd length");var u=M(r,Pt(r.length,1)),f=Pt(0,o),s=Pt(n,2),c=new Array(a),d=e(M(f,t,s,Pt(0,1),u));c[0]=e(M(d,Pt(1,1),u));for(var h=1;h<=a;h++){var l=[Dt(d,c[h-1]),Pt(h+1,1),u];c[h]=e(M.apply(void 0,l))}return M.apply(void 0,c).slice(0,n)}(t,c,l,a);else if("xof"===u)s=function(t,r,n,e,i){if(Vt(t),Vt(r),Ft(n),r.length>255){var o=Math.ceil(2*e/8);r=i.create({dkLen:o}).update(Y("H2C-OVERSIZE-DST-")).update(r).digest()}if(n>65535||r.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:n}).update(t).update(Pt(n,2)).update(r).update(Pt(r.length,1)).digest()}(t,c,l,i,a);else{if("_internal_pass"!==u)throw new Error('expand must be "xmd" or "xof"');s=t}for(var v=new Array(r),y=0;y<r;y++){for(var g=new Array(o),p=0;p<o;p++){var w=h*(p+y*o),m=s.subarray(w,w+h);g[p]=dt(Ct(m),e)}v[y]=g}return v}var zt=function(t){(0,a.Z)(n,t);var r=(0,u.Z)(n);function n(t,e){var o;(0,i.Z)(this,n),(o=r.call(this)).finished=!1,o.destroyed=!1,d(t);var a=w(e);if(o.iHash=t.create(),"function"!==typeof o.iHash.update)throw new Error("Expected instance of class which extends utils.Hash");o.blockLen=o.iHash.blockLen,o.outputLen=o.iHash.outputLen;var u=o.blockLen,f=new Uint8Array(u);f.set(a.length>u?t.create().update(a).digest():a);for(var s=0;s<f.length;s++)f[s]^=54;o.iHash.update(f),o.oHash=t.create();for(var c=0;c<f.length;c++)f[c]^=106;return o.oHash.update(f),f.fill(0),o}return(0,o.Z)(n,[{key:"update",value:function(t){return h(this),this.iHash.update(t),this}},{key:"digestInto",value:function(t){h(this),c(t,this.outputLen),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}},{key:"digest",value:function(){var t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}},{key:"_cloneInto",value:function(t){t||(t=Object.create(Object.getPrototypeOf(this),{}));var r=this.oHash,n=this.iHash,e=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return t.finished=e,t.destroyed=i,t.blockLen=o,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),n}(b),Kt=function(t,r,n){return new zt(t,r).update(n).digest()};function jt(t){return{hash:t,hmac:function(r){for(var n=arguments.length,e=new Array(n>1?n-1:0),i=1;i<n;i++)e[i-1]=arguments[i];return Kt(t,r,m.apply(void 0,e))},randomBytes:B}}Kt.create=function(t,r){return new zt(t,r)};var Mt=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Wt=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),Yt=BigInt(1),Gt=BigInt(2),Xt=function(t,r){return(t+r/Gt)/r};function Jt(t){var r=Mt,n=BigInt(3),e=BigInt(6),i=BigInt(11),o=BigInt(22),a=BigInt(23),u=BigInt(44),f=BigInt(88),s=t*t*t%r,c=s*s*t%r,d=lt(c,n,r)*c%r,h=lt(d,n,r)*c%r,l=lt(h,Gt,r)*s%r,v=lt(l,i,r)*l%r,y=lt(v,o,r)*v%r,g=lt(y,u,r)*y%r,p=lt(g,f,r)*g%r,w=lt(p,u,r)*y%r,m=lt(w,n,r)*c%r,b=lt(m,a,r)*v%r,E=lt(b,e,r)*s%r,B=lt(E,Gt,r);if(!Qt.eql(Qt.sqr(B),t))throw new Error("Cannot find square root");return B}var Qt=function(t,r){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t<=it)throw new Error("Expected Field ORDER > 0, got ".concat(t));var i=wt(t,r),o=i.nBitLength,a=i.nByteLength;if(a>2048)throw new Error("Field lengths over 2048 bytes are not supported");var u=yt(t),f=Object.freeze({ORDER:t,BITS:o,BYTES:a,MASK:Q(o),ZERO:it,ONE:ot,create:function(r){return dt(r,t)},isValid:function(r){if("bigint"!==typeof r)throw new Error("Invalid field element: expected bigint, got ".concat(typeof r));return it<=r&&r<t},is0:function(t){return t===it},isOdd:function(t){return(t&ot)===ot},neg:function(r){return dt(-r,t)},eql:function(t,r){return t===r},sqr:function(r){return dt(r*r,t)},add:function(r,n){return dt(r+n,t)},sub:function(r,n){return dt(r-n,t)},mul:function(r,n){return dt(r*n,t)},pow:function(t,r){return function(t,r,n){if(n<it)throw new Error("Expected power > 0");if(n===it)return t.ONE;if(n===ot)return r;for(var e=t.ONE,i=r;n>it;)n&ot&&(e=t.mul(e,i)),i=t.sqr(i),n>>=ot;return e}(f,t,r)},div:function(r,n){return dt(r*vt(n,t),t)},sqrN:function(t){return t*t},addN:function(t,r){return t+r},subN:function(t,r){return t-r},mulN:function(t,r){return t*r},inv:function(r){return vt(r,t)},sqrt:e.sqrt||function(t){return u(f,t)},invertBatch:function(t){return function(t,r){var n=new Array(r.length),e=r.reduce((function(r,e,i){return t.is0(e)?r:(n[i]=r,t.mul(r,e))}),t.ONE),i=t.inv(e);return r.reduceRight((function(r,e,i){return t.is0(e)?r:(n[i]=t.mul(r,n[i]),t.mul(r,e))}),i),n}(f,t)},cmov:function(t,r,n){return n?r:t},toBytes:function(t){return n?z(t,a):_(t,a)},fromBytes:function(t){if(t.length!==a)throw new Error("Fp.fromBytes: expected ".concat(a,", got ").concat(t.length));return n?F(t):V(t)}});return Object.freeze(f)}(Mt,void 0,void 0,{sqrt:Jt}),$t=function(t,r){var n=function(r){return Nt((0,Bt.Z)((0,Bt.Z)({},t),jt(r)))};return Object.freeze((0,Bt.Z)((0,Bt.Z)({},n(r)),{},{create:n}))}({a:BigInt(0),b:BigInt(7),Fp:Qt,n:Wt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:function(t){var r=Wt,n=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),e=-Yt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=n,a=BigInt("0x100000000000000000000000000000000"),u=Xt(o*t,r),f=Xt(-e*t,r),s=dt(t-u*n-f*i,r),c=dt(-u*e-f*o,r),d=s>a,h=c>a;if(d&&(s=r-s),h&&(c=r-c),s>a||c>a)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:d,k1:s,k2neg:h,k2:c}}}},Z),tr=BigInt(0),rr=function(t){return"bigint"===typeof t&&tr<t&&t<Mt},nr=function(t){return"bigint"===typeof t&&tr<t&&t<Wt},er={};function ir(t){var r=er[t];if(void 0===r){var n=Z(Uint8Array.from(t,(function(t){return t.charCodeAt(0)})));r=M(n,n),er[t]=r}for(var e=arguments.length,i=new Array(e>1?e-1:0),o=1;o<e;o++)i[o-1]=arguments[o];return Z(M.apply(void 0,[r].concat(i)))}var or=function(t){return t.toRawBytes(!0).slice(1)},ar=function(t){return _(t,32)},ur=function(t){return dt(t,Mt)},fr=function(t){return dt(t,Wt)},sr=$t.ProjectivePoint,cr=function(t,r,n){return sr.BASE.multiplyAndAddUnsafe(t,r,n)};function dr(t){var r=$t.utils.normPrivateKeyToScalar(t),n=sr.fromPrivateKey(r);return{scalar:n.hasEvenY()?r:fr(-r),bytes:or(n)}}function hr(t){if(!rr(t))throw new Error("bad x: need 0 < x < p");var r=ur(t*t),n=Jt(ur(r*t+BigInt(7)));n%Gt!==tr&&(n=ur(-n));var e=new sr(t,n,Yt);return e.assertValidity(),e}function lr(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return fr(V(ir.apply(void 0,["BIP0340/challenge"].concat(r))))}function vr(t){return dr(t).bytes}function yr(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:B(32),e=j("message",t),i=dr(r),o=i.bytes,a=i.scalar,u=j("auxRand",n,32),f=ar(a^V(ir("BIP0340/aux",u))),s=ir("BIP0340/nonce",f,o,e),c=fr(V(s));if(c===tr)throw new Error("sign failed: k is zero");var d=dr(c),h=d.bytes,l=d.scalar,v=lr(h,o,e),y=new Uint8Array(64);if(y.set(h,0),y.set(ar(fr(l+v*a)),32),!gr(y,e,o))throw new Error("sign: Invalid signature produced");return y}function gr(t,r,n){var e=j("signature",t,64),i=j("message",r),o=j("publicKey",n,32);try{var a=hr(V(o)),u=V(e.subarray(0,32));if(!rr(u))return!1;var f=V(e.subarray(32,64));if(!nr(f))return!1;var s=lr(ar(u),or(a),i),c=cr(a,f,fr(-s));return!(!c||!c.hasEvenY()||c.toAffine().x!==u)}catch(d){return!1}}var pr=function(){return{getPublicKey:vr,sign:yr,verify:gr,utils:{randomPrivateKey:$t.utils.randomPrivateKey,lift_x:hr,pointToBytes:or,numberToBytesBE:_,bytesToNumberBE:V,taggedHash:ir,mod:dt}}}(),wr=function(){return function(t,r){var n=r.map((function(t){return Array.from(t).reverse()}));return function(r,e){var i=n.map((function(n){return n.reduce((function(n,e){return t.add(t.mul(n,r),e)}))})),o=(0,R.Z)(i,4),a=o[0],u=o[1],f=o[2],s=o[3];return r=t.div(a,u),e=t.mul(e,t.div(f,s)),{x:r,y:e}}}(Qt,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map((function(t){return t.map((function(t){return BigInt(t)}))})))}(),mr=function(){return Ht(Qt,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:Qt.create(BigInt("-11"))})}(),br=function(){return function(t,r,n){if("function"!==typeof r)throw new Error("mapToCurve() must be defined");return{hashToCurve:function(e,i){var o=_t(e,2,(0,Bt.Z)((0,Bt.Z)({},n),{},{DST:n.DST},i)),a=t.fromAffine(r(o[0])),u=t.fromAffine(r(o[1])),f=a.add(u).clearCofactor();return f.assertValidity(),f},encodeToCurve:function(e,i){var o=_t(e,1,(0,Bt.Z)((0,Bt.Z)({},n),{},{DST:n.encodeDST},i)),a=t.fromAffine(r(o[0])).clearCofactor();return a.assertValidity(),a}}}($t.ProjectivePoint,(function(t){var r=mr(Qt.create(t[0])),n=r.x,e=r.y;return wr(n,e)}),{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:Qt.ORDER,m:1,k:128,expand:"xmd",hash:Z})}(),Er=function(){return br.hashToCurve}(),Br=function(){return br.encodeToCurve}()}}]);
//# sourceMappingURL=1768.ab884538.chunk.js.map