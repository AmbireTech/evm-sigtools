"use strict";(self.webpackChunkevm_sigtools=self.webpackChunkevm_sigtools||[]).push([[8865],{68865:(e,s,t)=>{s.SafeAppProvider=void 0;var a=t(32574);Object.defineProperty(s,"SafeAppProvider",{enumerable:!0,get:function(){return a.SafeAppProvider}})},32574:(e,s,t)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.SafeAppProvider=void 0;const a=t(75121),r=t(90821);class i extends a.EventEmitter{constructor(e,s){super(),this.submittedTxs=new Map,this.safe=e,this.sdk=s}async connect(){this.emit("connect",{chainId:this.chainId})}async disconnect(){}get chainId(){return this.safe.chainId}async request(e){const{method:s,params:t=[]}=e;switch(s){case"eth_accounts":return[this.safe.safeAddress];case"net_version":case"eth_chainId":return`0x${this.chainId.toString(16)}`;case"personal_sign":{const[e,s]=t;if(this.safe.safeAddress.toLowerCase()!==s.toLowerCase())throw new Error("The address or message hash is invalid");const a=await this.sdk.txs.signMessage(e);return("signature"in a?a.signature:void 0)||"0x"}case"eth_sign":{const[e,s]=t;if(this.safe.safeAddress.toLowerCase()!==e.toLowerCase()||!s.startsWith("0x"))throw new Error("The address or message hash is invalid");const a=await this.sdk.txs.signMessage(s);return("signature"in a?a.signature:void 0)||"0x"}case"eth_signTypedData":case"eth_signTypedData_v4":{const[e,s]=t,a="string"===typeof s?JSON.parse(s):s;if(this.safe.safeAddress.toLowerCase()!==e.toLowerCase())throw new Error("The address is invalid");const r=await this.sdk.txs.signTypedMessage(a);return("signature"in r?r.signature:void 0)||"0x"}case"eth_sendTransaction":const s=Object.assign({value:"0",data:"0x"},t[0]);"string"===typeof s.gas&&s.gas.startsWith("0x")&&(s.gas=parseInt(s.gas,16));const i=await this.sdk.txs.send({txs:[s],params:{safeTxGas:s.gas}});return this.submittedTxs.set(i.safeTxHash,{from:this.safe.safeAddress,hash:i.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:s.data,value:s.value,to:s.to,blockHash:null,blockNumber:null,transactionIndex:null}),i.safeTxHash;case"eth_blockNumber":return(await this.sdk.eth.getBlockByNumber(["latest"])).number;case"eth_getBalance":return this.sdk.eth.getBalance([(0,r.getLowerCase)(t[0]),t[1]]);case"eth_getCode":return this.sdk.eth.getCode([(0,r.getLowerCase)(t[0]),t[1]]);case"eth_getTransactionCount":return this.sdk.eth.getTransactionCount([(0,r.getLowerCase)(t[0]),t[1]]);case"eth_getStorageAt":return this.sdk.eth.getStorageAt([(0,r.getLowerCase)(t[0]),t[1],t[2]]);case"eth_getBlockByNumber":return this.sdk.eth.getBlockByNumber([t[0],t[1]]);case"eth_getBlockByHash":return this.sdk.eth.getBlockByHash([t[0],t[1]]);case"eth_getTransactionByHash":let n=t[0];try{n=(await this.sdk.txs.getBySafeTxHash(n)).txHash||n}catch(a){}return this.submittedTxs.has(n)?this.submittedTxs.get(n):this.sdk.eth.getTransactionByHash([n]).then((e=>(e&&(e.hash=t[0]),e)));case"eth_getTransactionReceipt":{let e=t[0];try{e=(await this.sdk.txs.getBySafeTxHash(e)).txHash||e}catch(a){}return this.sdk.eth.getTransactionReceipt([e]).then((e=>(e&&(e.transactionHash=t[0]),e)))}case"eth_estimateGas":return this.sdk.eth.getEstimateGas(t[0]);case"eth_call":return this.sdk.eth.call([t[0],t[1]]);case"eth_getLogs":return this.sdk.eth.getPastLogs([t[0]]);case"eth_gasPrice":return this.sdk.eth.getGasPrice();case"wallet_getPermissions":return this.sdk.wallet.getPermissions();case"wallet_requestPermissions":return this.sdk.wallet.requestPermissions(t[0]);case"safe_setSettings":return this.sdk.eth.setSafeSettings([t[0]]);default:throw Error(`"${e.method}" not implemented`)}}send(e,s){e||s("Undefined request"),this.request(e).then((t=>s(null,{jsonrpc:"2.0",id:e.id,result:t}))).catch((e=>s(e,null)))}}s.SafeAppProvider=i},90821:(e,s)=>{Object.defineProperty(s,"__esModule",{value:!0}),s.getLowerCase=void 0,s.getLowerCase=function(e){return e?e.toLowerCase():e}}}]);
//# sourceMappingURL=8865.290c1355.chunk.js.map