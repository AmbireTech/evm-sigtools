"use strict";(self.webpackChunkevm_sigtools=self.webpackChunkevm_sigtools||[]).push([[7598],{67598:function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.SafeAppProvider=void 0;var s=r(24488);Object.defineProperty(t,"SafeAppProvider",{enumerable:!0,get:function(){return s.SafeAppProvider}})},24488:function(e,t,r){var s=r(63038).default,a=r(87757),n=r(48926).default,u=r(34575).default,i=r(93913).default,c=r(2205).default,o=r(99842).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SafeAppProvider=void 0;var h=r(47465),d=r(96275),p=function(e){c(r,e);var t=o(r);function r(e,s){var a;return u(this,r),(a=t.call(this)).submittedTxs=new Map,a.safe=e,a.sdk=s,a}return i(r,[{key:"connect",value:function(){var e=n(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.emit("connect",{chainId:this.chainId}),e.abrupt("return");case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=n(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"chainId",get:function(){return this.safe.chainId}},{key:"request",value:function(){var e=n(a.mark((function e(t){var r,n,u,i,c,o,h,p,f,g,l,b,k,v,x,m,w,_,y,T,C,P,B,L,S,H;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.method,n=t.params,u=void 0===n?[]:n,e.t0=r,e.next="eth_accounts"===e.t0?4:"net_version"===e.t0||"eth_chainId"===e.t0?5:"personal_sign"===e.t0?6:"eth_sign"===e.t0?14:"eth_signTypedData"===e.t0||"eth_signTypedData_v4"===e.t0?22:"eth_sendTransaction"===e.t0?31:"eth_blockNumber"===e.t0?38:"eth_getBalance"===e.t0?42:"eth_getCode"===e.t0?43:"eth_getTransactionCount"===e.t0?44:"eth_getStorageAt"===e.t0?45:"eth_getBlockByNumber"===e.t0?46:"eth_getBlockByHash"===e.t0?47:"eth_getTransactionByHash"===e.t0?48:"eth_getTransactionReceipt"===e.t0?61:"eth_estimateGas"===e.t0?72:"eth_call"===e.t0?73:"eth_getLogs"===e.t0?74:"eth_gasPrice"===e.t0?75:"wallet_getPermissions"===e.t0?76:"wallet_requestPermissions"===e.t0?77:"safe_setSettings"===e.t0?78:79;break;case 4:return e.abrupt("return",[this.safe.safeAddress]);case 5:return e.abrupt("return","0x".concat(this.chainId.toString(16)));case 6:if(i=s(u,2),c=i[0],o=i[1],this.safe.safeAddress.toLowerCase()===o.toLowerCase()){e.next=9;break}throw new Error("The address or message hash is invalid");case 9:return e.next=11,this.sdk.txs.signMessage(c);case 11:return h=e.sent,p="signature"in h?h.signature:void 0,e.abrupt("return",p||"0x");case 14:if(f=s(u,2),g=f[0],l=f[1],this.safe.safeAddress.toLowerCase()===g.toLowerCase()&&l.startsWith("0x")){e.next=17;break}throw new Error("The address or message hash is invalid");case 17:return e.next=19,this.sdk.txs.signMessage(l);case 19:return b=e.sent,k="signature"in b?b.signature:void 0,e.abrupt("return",k||"0x");case 22:if(v=s(u,2),x=v[0],m=v[1],w="string"===typeof m?JSON.parse(m):m,this.safe.safeAddress.toLowerCase()===x.toLowerCase()){e.next=26;break}throw new Error("The address is invalid");case 26:return e.next=28,this.sdk.txs.signTypedMessage(w);case 28:return _=e.sent,y="signature"in _?_.signature:void 0,e.abrupt("return",y||"0x");case 31:return"string"===typeof(T=Object.assign({value:"0",data:"0x"},u[0])).gas&&T.gas.startsWith("0x")&&(T.gas=parseInt(T.gas,16)),e.next=35,this.sdk.txs.send({txs:[T],params:{safeTxGas:T.gas}});case 35:return C=e.sent,this.submittedTxs.set(C.safeTxHash,{from:this.safe.safeAddress,hash:C.safeTxHash,gas:0,gasPrice:"0x00",nonce:0,input:T.data,value:T.value,to:T.to,blockHash:null,blockNumber:null,transactionIndex:null}),e.abrupt("return",C.safeTxHash);case 38:return e.next=40,this.sdk.eth.getBlockByNumber(["latest"]);case 40:return P=e.sent,e.abrupt("return",P.number);case 42:return e.abrupt("return",this.sdk.eth.getBalance([(0,d.getLowerCase)(u[0]),u[1]]));case 43:return e.abrupt("return",this.sdk.eth.getCode([(0,d.getLowerCase)(u[0]),u[1]]));case 44:return e.abrupt("return",this.sdk.eth.getTransactionCount([(0,d.getLowerCase)(u[0]),u[1]]));case 45:return e.abrupt("return",this.sdk.eth.getStorageAt([(0,d.getLowerCase)(u[0]),u[1],u[2]]));case 46:return e.abrupt("return",this.sdk.eth.getBlockByNumber([u[0],u[1]]));case 47:return e.abrupt("return",this.sdk.eth.getBlockByHash([u[0],u[1]]));case 48:return B=u[0],e.prev=49,e.next=52,this.sdk.txs.getBySafeTxHash(B);case 52:L=e.sent,B=L.txHash||B,e.next=58;break;case 56:e.prev=56,e.t1=e.catch(49);case 58:if(!this.submittedTxs.has(B)){e.next=60;break}return e.abrupt("return",this.submittedTxs.get(B));case 60:return e.abrupt("return",this.sdk.eth.getTransactionByHash([B]).then((function(e){return e&&(e.hash=u[0]),e})));case 61:return S=u[0],e.prev=62,e.next=65,this.sdk.txs.getBySafeTxHash(S);case 65:H=e.sent,S=H.txHash||S,e.next=71;break;case 69:e.prev=69,e.t2=e.catch(62);case 71:return e.abrupt("return",this.sdk.eth.getTransactionReceipt([S]).then((function(e){return e&&(e.transactionHash=u[0]),e})));case 72:return e.abrupt("return",this.sdk.eth.getEstimateGas(u[0]));case 73:return e.abrupt("return",this.sdk.eth.call([u[0],u[1]]));case 74:return e.abrupt("return",this.sdk.eth.getPastLogs([u[0]]));case 75:return e.abrupt("return",this.sdk.eth.getGasPrice());case 76:return e.abrupt("return",this.sdk.wallet.getPermissions());case 77:return e.abrupt("return",this.sdk.wallet.requestPermissions(u[0]));case 78:return e.abrupt("return",this.sdk.eth.setSafeSettings([u[0]]));case 79:throw Error('"'.concat(t.method,'" not implemented'));case 80:case"end":return e.stop()}}),e,this,[[49,56],[62,69]])})));return function(t){return e.apply(this,arguments)}}()},{key:"send",value:function(e,t){e||t("Undefined request"),this.request(e).then((function(r){return t(null,{jsonrpc:"2.0",id:e.id,result:r})})).catch((function(e){return t(e,null)}))}}]),r}(h.EventEmitter);t.SafeAppProvider=p},96275:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getLowerCase=void 0,t.getLowerCase=function(e){return e?e.toLowerCase():e}}}]);
//# sourceMappingURL=7598.f8887c59.chunk.js.map